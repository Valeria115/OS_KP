DAG Task Scheduler

Профессиональный планировщик задач с поддержкой зависимостей, параллельного выполнения и ограничений ресурсов. Аналог упрощенных CI/CD систем (GitLab CI, GitHub Actions) и планировщиков вычислений (Apache Airflow).

Возможности

- **Параллельное выполнение задач** с ограничением через `max_concurrent`
- **Зависимости между задачами** (DAG - Directed Acyclic Graph)
- **Семафоры для ресурсов** (GPU, CPU, IO, database и др.)
- **Аварийная остановка** при ошибке в любой задаче
- **Валидация конфигурации** (проверка циклов, связности графа)
- **Детальная статистика** выполнения всех задач
- **YAML-конфигурация** для удобного описания workflow

Сборка проекта

```bash
# Клонирование репозитория
git clone git@github.com:Valeria115/OS_KP.git
cd OS_KP

# Создание директории сборки
mkdir -p build
cd build

# Сборка проекта
cmake ..
make
```

Запуск

```bash
# Возвращаемся в корень проекта
cd ..

# Запуск с тестовым конфигом
./build/dag_executor config.yaml
```

Формат конфигурации (config.yaml)

```yaml
# Общее ограничение параллельных задач
max_concurrent: 3

# Определение семафоров
semaphores:
  - name: "gpu"
    value: 2  # Одновременно 2 задачи могут использовать GPU
  - name: "database"
    value: 1  # Только 1 задача может обращаться к БД

# Описание задач
jobs:
  - id: "prepare_data"
    cmd: "echo 'Подготовка данных' && sleep 1"
    
  - id: "train_model"
    cmd: "echo 'Обучение модели' && sleep 3"
    needs: ["prepare_data"]  # Зависит от prepare_data
    semaphores: ["gpu"]  # Требует GPU
    
  - id: "validate"
    cmd: "echo 'Валидация' && sleep 2"
    needs: ["train_model"]  # Зависит от train_model
    
  - id: "deploy"
    cmd: "echo 'Деплой' && sleep 1"
    needs: ["validate"]  # Зависит от validate
```

Требования

- **C++17** компилятор (g++ 7.0+ или clang++ 5.0+)
- **CMake** 3.10+
- **yaml-cpp** библиотека
- **Linux** (используются POSIX семафоры и системные вызовы)

Установка зависимостей

```bash
sudo apt-get update
sudo apt-get install -y g++ cmake libyaml-cpp-dev
```

Валидация конфигурации

Программа автоматически проверяет:
- ✅ Отсутствие циклов в графе зависимостей
- ✅ Связность графа (все задачи соединены)
- ✅ Наличие хотя бы одной стартовой задачи (без зависимостей)
- ✅ Наличие хотя бы одной завершающей задачи (без зависимых)
- ✅ Существование всех указанных зависимостей

Особенности реализации

Архитектура
- **Модульная структура** с четким разделением ответственности
- **Глобальные атомарные переменные** для thread-safe работы
- **Гибридная модель**: процессы для изоляции задач + потоки для наблюдения

Безопасность
- **Deadlock prevention**: семафоры захватываются в отсортированном порядке
- **Graceful shutdown**: SIGTERM → пауза → SIGKILL для дочерних процессов
- **Атомарные операции** для всех shared ресурсов

Производительность
- **Busy-wait prevention**: sleep 50ms между проверками задач
- **Минимальная блокировка**: только при запуске/завершении задач
- **Параллельное выполнение** с учетом всех ограничений

Выходные данные

Программа выводит:
1. Сообщение о начале выполнения с параметром `max_concurrent`
2. Вывод всех выполняемых команд
3. Статистику по завершении:
   ```
   Execution completed
   startexit=0 started=1finished=1
   task_aexit=0 started=1finished=1
   task_bexit=0 started=1finished=1
   ```

Коды завершения:
- `0` - все задачи выполнены успешно
- `1` - ошибка в аргументах командной строки
- `2` - ошибка парсинга конфигурации
- `3` - ошибка валидации графа
- `1` (в конце) - хотя бы одна задача завершилась с ошибкой
